{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport Link from 'next/link';\nimport marked from 'marked';\nimport Parallax from 'parallax-js';\nimport moment from 'moment';\nimport Styles from '../styles/index/index.module.scss';\nimport { getIndexPageData } from '../api/api';\nimport { message, Tooltip } from 'antd';\nimport { SortDescendingOutlined, FontColorsOutlined, MehOutlined, HeartOutlined, AlignRightOutlined, CloseOutlined } from '@ant-design/icons';\nimport LoadingDom from '../components/loading';\nimport { setInterval } from 'timers';\nimport Helmet from '../components/Helmet';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"scene\", /*#__PURE__*/React.createRef());\n\n    _defineProperty(this, \"timer\", null);\n\n    _defineProperty(this, \"disposeScreen\", () => {\n      const width = document.body.clientWidth;\n      const height = document.body.clientHeight;\n      const {\n        featherBox,\n        imgBoxStyle\n      } = this.calculateFatherBox(width, height);\n      this.setState({\n        fatherBox: featherBox,\n        screenHeight: height,\n        imgBoxStyle: imgBoxStyle\n      });\n    });\n\n    _defineProperty(this, \"loadMore\", () => {\n      const {\n        pageNo,\n        pageSize\n      } = this.state;\n      this.setState(() => ({\n        pageSize: this.state.pageSize + 5\n      }));\n      this.initData(pageNo, pageSize + 5);\n    });\n\n    _defineProperty(this, \"initParallax\", DOMElement => {\n      new Parallax(DOMElement, {\n        relativeInput: true,\n        clipRelativeInput: true\n      });\n    });\n\n    _defineProperty(this, \"onNavHide\", blg => {\n      this.setState({\n        navHied: blg\n      });\n      const body = document.querySelector('body');\n\n      if (blg) {\n        body.style.overflowY = \"hidden\";\n      } else {\n        body.style.overflowY = \"\";\n      }\n    });\n\n    _defineProperty(this, \"onSlide\", () => {\n      this.animate(0);\n    });\n\n    _defineProperty(this, \"animate\", (targe, callback) => {\n      this.timer = setInterval(() => {\n        let step = (targe - window.pageYOffset) / 10;\n        step = step >= 0 ? Math.ceil(step) : Math.floor(step);\n\n        if (window.pageYOffset === targe) {\n          clearInterval(this.timer._id);\n          callback && callback();\n        }\n\n        window.scroll(0, window.pageYOffset + step);\n      }, 15);\n    });\n\n    _defineProperty(this, \"renderNav\", () => /*#__PURE__*/_jsxs(\"div\", {\n      className: Styles.nav,\n      style: !this.state.navHied ? {\n        top: '-100%'\n      } : {\n        top: '0'\n      },\n      children: [/*#__PURE__*/_jsxs(\"ul\", {\n        className: Styles.nav_list,\n        children: [/*#__PURE__*/_jsx(\"li\", {\n          children: /*#__PURE__*/_jsx(\"a\", {\n            href: \"/article\",\n            children: \"Article\"\n          })\n        }), /*#__PURE__*/_jsx(\"li\", {\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/subscribe\",\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: \"Subscribe\"\n            })\n          })\n        }), /*#__PURE__*/_jsxs(\"li\", {\n          children: [/*#__PURE__*/_jsx(Link, {\n            href: \"/aboutMe\",\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: \"AboutMe\"\n            })\n          }), \" \"]\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: Styles.word,\n        children: /*#__PURE__*/_jsx(\"span\", {\n          children: \"Everywhere in the world has a similar life.\"\n        })\n      })]\n    }));\n\n    _defineProperty(this, \"renderBlogList\", () => {\n      const {\n        blogList\n      } = this.state;\n      return blogList.map(item => /*#__PURE__*/_jsxs(\"div\", {\n        className: Styles.post,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Styles.img_box,\n          children: /*#__PURE__*/_jsx(Link, {\n            href: `/[${String(item.id)}]`,\n            as: `/${String(item.id)}`,\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: item.imgUrl,\n                alt: \"\"\n              })\n            })\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: Styles.info,\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: Styles.time,\n            children: moment(item.createDate).format('YYYY-MM-DD')\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: Styles.title,\n            children: /*#__PURE__*/_jsx(Link, {\n              href: '/' + String(item.id),\n              children: /*#__PURE__*/_jsx(\"a\", {\n                style: {\n                  color: 'black'\n                },\n                children: item.title\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: Styles.text,\n            dangerouslySetInnerHTML: {\n              __html: marked(item.content, {\n                gfm: true,\n                xhtml: false\n              })\n            }\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Styles.stuff,\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsxs(Tooltip, {\n                title: \"\\u5B57\\u7B26\",\n                color: \"#ef6d57\",\n                overlayStyle: {\n                  borderRadius: '4px'\n                },\n                children: [/*#__PURE__*/_jsx(FontColorsOutlined, {\n                  className: Styles.icon\n                }), /*#__PURE__*/_jsx(\"span\", {\n                  className: Styles.charts,\n                  children: item.number_words\n                })]\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsxs(Tooltip, {\n                title: \"\\u67E5\\u770B\",\n                color: \"#50bcb6\",\n                overlayStyle: {\n                  borderRadius: '4px'\n                },\n                children: [/*#__PURE__*/_jsx(MehOutlined, {\n                  className: Styles.icon\n                }), /*#__PURE__*/_jsx(\"span\", {\n                  className: Styles.charts,\n                  children: item.viewCount\n                })]\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsxs(Tooltip, {\n                title: \"\\u70B9\\u8D5E\",\n                color: \"#ffa800\",\n                overlayStyle: {\n                  borderRadius: '4px'\n                },\n                children: [/*#__PURE__*/_jsx(HeartOutlined, {\n                  className: Styles.icon\n                }), /*#__PURE__*/_jsx(\"span\", {\n                  className: Styles.charts,\n                  children: item.likeCount\n                })]\n              })\n            })]\n          })]\n        })]\n      }, item.id));\n    });\n\n    _defineProperty(this, \"renderHomeBlogList\", () => {\n      const {\n        blogList\n      } = this.state;\n      const item = blogList.length > 0 ? blogList[blogList.length - 1] : {\n        id: 1,\n        createDate: '',\n        content: '',\n        title: ''\n      };\n      return /*#__PURE__*/_jsxs(\"div\", {\n        className: Styles.info,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Styles.time,\n          children: moment(item.createDate).format('YYYY-MM-DD')\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.title,\n          children: /*#__PURE__*/_jsx(Link, {\n            href: '/' + String(item.id),\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: item.title\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.text,\n          dangerouslySetInnerHTML: {\n            __html: marked(item.content, {\n              gfm: true,\n              xhtml: false\n            })\n          }\n        })]\n      });\n    });\n\n    this.state = {\n      fatherBox: {},\n      imgBoxStyle: {},\n      navHied: false,\n      loadingMore: false,\n      screenHeight: 0,\n      blogList: [],\n      pageNo: 1,\n      pageSize: 5,\n      total: 0\n    };\n  }\n\n  componentDidMount() {\n    const {\n      pageNo,\n      pageSize\n    } = this.state;\n    this.initParallax(this.scene.current);\n    window.addEventListener('resize', this.disposeScreen, false);\n    this.disposeScreen();\n    document.addEventListener('scroll', () => {\n      clearInterval(this.timer);\n    });\n    this.initData(pageNo, pageSize);\n  }\n\n  async initData(pageNo, pageSize) {\n    this.setState({\n      loadingMore: true\n    });\n    const responseData = await getBlogList({\n      pageNo,\n      pageSize\n    });\n    this.setState({\n      blogList: responseData.list,\n      total: responseData.total,\n      loadingMore: false\n    });\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.disposeScreen);\n  }\n\n  calculateFatherBox(w, h) {\n    let _w = parseInt(w),\n        _h = parseInt(h),\n        x,\n        y,\n        i,\n        e = _w >= 1000 || _h >= 1000 ? 1000 : 500;\n\n    if (_w >= _h) {\n      i = _w / e * 50;\n      y = i;\n      x = i * _w / _h;\n    } else {\n      i = _h / e * 50;\n      x = i;\n      y = i * _h / _w;\n    }\n\n    const featherBox = {\n      width: _w + x + 'px',\n      height: _h + y + 'px',\n      marginLeft: -0.5 * x + 'px',\n      marginTop: -0.5 * y + 'px'\n    };\n    const imgBoxStyle = this.calculateBox(_w + x, _h + y);\n    return {\n      featherBox,\n      imgBoxStyle\n    };\n  }\n\n  calculateBox(w, h) {\n    const width = parseInt(w),\n          height = parseInt(h),\n          ratio = 1080 / 1920,\n          style = {};\n    const compute = height / width > ratio;\n    style['width'] = compute ? height / ratio + 'px' : `${width}px`;\n    style['height'] = compute ? `${height}px` : width * ratio + 'px';\n    style['left'] = (width - parseInt(style.width)) / 2 + 'px';\n    style['top'] = (height - parseInt(style.height)) / 2 + 'px';\n    return style;\n  } // 我是真塔喵的菜\n\n\n  render() {\n    return /*#__PURE__*/_jsxs(\"div\", {\n      className: Styles.container,\n      children: [/*#__PURE__*/_jsx(Helmet, {\n        title: \" home | \\u5C0F\\u818F\"\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Styles.home,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          ref: this.scene,\n          className: Styles.scene,\n          style: {\n            height: this.state.screenHeight + 'px'\n          },\n          children: /*#__PURE__*/_jsx(\"div\", {\n            \"data-depth\": \"0.4\",\n            className: Styles.bg,\n            style: this.state.fatherBox,\n            children: /*#__PURE__*/_jsx(\"img\", {\n              src: \"/image/bg.png\",\n              style: this.state.imgBoxStyle\n            })\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: Styles.head,\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: Styles.logo,\n            style: !this.state.navHied ? {\n              color: '#fff'\n            } : {\n              color: '#333'\n            },\n            children: /*#__PURE__*/_jsx(\"i\", {\n              className: \"web-font\",\n              children: \"\\u5C0F \\xB7 \\u818F\"\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: Styles.menu,\n            children: !this.state.navHied ? /*#__PURE__*/_jsx(AlignRightOutlined, {\n              className: \"iconfont\",\n              onClick: () => this.onNavHide(true)\n            }) : /*#__PURE__*/_jsx(CloseOutlined, {\n              onClick: () => this.onNavHide(false),\n              className: \"iconfont\"\n            })\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.misk\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.post,\n          children: this.renderHomeBlogList()\n        }), this.renderNav()]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Styles.content,\n        children: [this.renderBlogList(), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.more,\n          children: this.state.total === this.state.blogList.length ? /*#__PURE__*/_jsx(\"div\", {\n            className: Styles.bottomTest,\n            children: \"\\u5230\\u5E95\\u4E86\"\n          }) : this.state.loadingMore ? /*#__PURE__*/_jsx(LoadingDom, {}) : /*#__PURE__*/_jsx(\"div\", {\n            className: Styles.loadingBtn,\n            onClick: this.loadMore,\n            children: \"\\u52A0\\u8F7D\\u66F4\\u591A \"\n          })\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: Styles.foot,\n        children: /*#__PURE__*/_jsx(\"a\", {\n          target: \"_blank\",\n          children: \"\\u7CA4ICP\\u5907181222222\\u53F7\"\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: Styles.navigationBar,\n        onClick: this.onSlide,\n        children: /*#__PURE__*/_jsx(SortDescendingOutlined, {})\n      })]\n    });\n  }\n\n}\n\nexport const getBlogList = async params => {\n  try {\n    const {\n      data,\n      success\n    } = await getIndexPageData({\n      pageNo: params.pageNo,\n      pageSize: params.pageSize\n    });\n    if (!success) return message.error('请求错误');\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const getStaticProps = async context => {\n  return {\n    props: {},\n    revalidate: 1\n  };\n};\nexport default App;","map":null,"metadata":{},"sourceType":"module"}