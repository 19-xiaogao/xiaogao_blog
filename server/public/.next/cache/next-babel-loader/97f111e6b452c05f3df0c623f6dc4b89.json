{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useState } from 'react';\nimport { useRouter } from 'next/router';\nimport Texty from 'rc-texty';\nimport 'rc-texty/assets/index.css';\nimport Styles from '../styles/validationCss/index.module.scss';\nimport { subscribe_verify } from '../api/api';\nimport Helmet from '../components/Helmet';\nimport { message } from 'antd';\n\nvar Validation = function Validation() {\n  var router = useRouter();\n\n  var _useState = useState(''),\n      verifyCode = _useState[0],\n      setVerifyCode = _useState[1];\n\n  var _useState2 = useState(''),\n      warnMessage = _useState2[0],\n      setWarnMessage = _useState2[1];\n\n  var onVerifyCodeChange = function onVerifyCodeChange(e) {\n    setVerifyCode(e.target.value);\n  };\n\n  var urlParams = function urlParams() {\n    var location = window.location.href;\n    var params = location.split('?')[1].split('&');\n    return {\n      email: params[0].split('=')[1],\n      id: params[1].split('=')[1]\n    };\n  };\n\n  var submitVerify = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _urlParams, email, id, _yield$subscribe_veri, success;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(verifyCode.trim().length !== 6)) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\", setWarnMessage('请输入6位数'));\n\n            case 2:\n              _urlParams = urlParams(), email = _urlParams.email, id = _urlParams.id;\n              _context.next = 5;\n              return subscribe_verify({\n                VerificationCode: verifyCode,\n                email: email,\n                id: id\n              });\n\n            case 5:\n              _yield$subscribe_veri = _context.sent;\n              success = _yield$subscribe_veri.success;\n\n              if (success) {\n                _context.next = 9;\n                break;\n              }\n\n              return _context.abrupt(\"return\", message.error('验证邮箱失败'));\n\n            case 9:\n              message.success(\"验证邮箱成功\");\n              setVerifyCode('');\n              router.push('/');\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function submitVerify() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: Styles.bigBox,\n    children: [/*#__PURE__*/_jsx(Helmet, {\n      title: \"\\u9A8C\\u8BC1 | \\u5C0F\\u818F\"\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: Styles.validation,\n      children: [/*#__PURE__*/_jsx(\"h2\", {\n        children: \"\\u8BA2\\u9605\\u90AE\\u7BB1\\u9A8C\\u8BC1\"\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Styles.entryBox,\n        children: [/*#__PURE__*/_jsx(\"input\", {\n          type: \"text\",\n          placeholder: \"\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\",\n          onChange: onVerifyCodeChange\n        }), /*#__PURE__*/_jsx(\"button\", {\n          onClick: submitVerify,\n          children: \"\\u63D0\\u4EA4\"\n        })]\n      }), /*#__PURE__*/_jsx(Texty, {\n        className: Styles.rules,\n        children: warnMessage\n      })]\n    })]\n  });\n};\n\nexport default Validation;","map":null,"metadata":{},"sourceType":"module"}