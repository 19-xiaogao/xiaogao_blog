{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport Link from 'next/link';\nimport marked from 'marked';\nimport Parallax from 'parallax-js';\nimport moment from 'moment';\nimport Styles from '../styles/index/index.module.scss';\nimport { getIndexPageData } from '../api/api';\nimport { message, Tooltip } from 'antd';\nimport { SortDescendingOutlined, FontColorsOutlined, MehOutlined, HeartOutlined, AlignRightOutlined, CloseOutlined } from '@ant-design/icons';\nimport LoadingDom from '../components/loading';\nimport { setInterval } from 'timers';\nimport Helmet from '../components/Helmet';\n\nvar App = /*#__PURE__*/function (_React$Component) {\n  _inherits(App, _React$Component);\n\n  var _super = _createSuper(App);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"scene\", /*#__PURE__*/React.createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"timer\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"disposeScreen\", function () {\n      var width = document.body.clientWidth;\n      var height = document.body.clientHeight;\n\n      var _this$calculateFather = _this.calculateFatherBox(width, height),\n          featherBox = _this$calculateFather.featherBox,\n          imgBoxStyle = _this$calculateFather.imgBoxStyle;\n\n      _this.setState({\n        fatherBox: featherBox,\n        screenHeight: height,\n        imgBoxStyle: imgBoxStyle\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"loadMore\", function () {\n      var _this$state = _this.state,\n          pageNo = _this$state.pageNo,\n          pageSize = _this$state.pageSize;\n\n      _this.setState(function () {\n        return {\n          pageSize: _this.state.pageSize + 5\n        };\n      });\n\n      _this.initData(pageNo, pageSize + 5);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"initParallax\", function (DOMElement) {\n      new Parallax(DOMElement, {\n        relativeInput: true,\n        clipRelativeInput: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onNavHide\", function (blg) {\n      _this.setState({\n        navHied: blg\n      });\n\n      var body = document.querySelector('body');\n\n      if (blg) {\n        body.style.overflowY = \"hidden\";\n      } else {\n        body.style.overflowY = \"\";\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSlide\", function () {\n      _this.animate(0);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"animate\", function (targe, callback) {\n      _this.timer = setInterval(function () {\n        var step = (targe - window.pageYOffset) / 10;\n        step = step >= 0 ? Math.ceil(step) : Math.floor(step);\n\n        if (window.pageYOffset === targe) {\n          clearInterval(_this.timer._id);\n          callback && callback();\n        }\n\n        window.scroll(0, window.pageYOffset + step);\n      }, 15);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderNav\", function () {\n      return /*#__PURE__*/_jsxs(\"div\", {\n        className: Styles.nav,\n        style: !_this.state.navHied ? {\n          top: '-100%'\n        } : {\n          top: '0'\n        },\n        children: [/*#__PURE__*/_jsxs(\"ul\", {\n          className: Styles.nav_list,\n          children: [/*#__PURE__*/_jsx(\"li\", {\n            children: /*#__PURE__*/_jsx(\"a\", {\n              href: \"/article\",\n              children: \"Article\"\n            })\n          }), /*#__PURE__*/_jsx(\"li\", {\n            children: /*#__PURE__*/_jsx(Link, {\n              href: \"/subscribe\",\n              children: /*#__PURE__*/_jsx(\"a\", {\n                children: \"Subscribe\"\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"li\", {\n            children: [/*#__PURE__*/_jsx(Link, {\n              href: \"/aboutMe\",\n              children: /*#__PURE__*/_jsx(\"a\", {\n                children: \"AboutMe\"\n              })\n            }), \" \"]\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.word,\n          children: /*#__PURE__*/_jsx(\"span\", {\n            children: \"Everywhere in the world has a similar life.\"\n          })\n        })]\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderBlogList\", function () {\n      var blogList = _this.state.blogList;\n      return blogList.map(function (item) {\n        return /*#__PURE__*/_jsxs(\"div\", {\n          className: Styles.post,\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: Styles.img_box,\n            children: /*#__PURE__*/_jsx(Link, {\n              href: \"/[\".concat(String(item.id), \"]\"),\n              as: \"/\".concat(String(item.id)),\n              children: /*#__PURE__*/_jsx(\"a\", {\n                children: /*#__PURE__*/_jsx(\"img\", {\n                  src: item.imgUrl,\n                  alt: \"\"\n                })\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Styles.info,\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: Styles.time,\n              children: moment(item.createDate).format('YYYY-MM-DD')\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: Styles.title,\n              children: /*#__PURE__*/_jsx(Link, {\n                href: '/' + String(item.id),\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  style: {\n                    color: 'black'\n                  },\n                  children: item.title\n                })\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: Styles.text,\n              dangerouslySetInnerHTML: {\n                __html: marked(item.content, {\n                  gfm: true,\n                  xhtml: false\n                })\n              }\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: Styles.stuff,\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsxs(Tooltip, {\n                  title: \"\\u5B57\\u7B26\",\n                  color: \"#ef6d57\",\n                  overlayStyle: {\n                    borderRadius: '4px'\n                  },\n                  children: [/*#__PURE__*/_jsx(FontColorsOutlined, {\n                    className: Styles.icon\n                  }), /*#__PURE__*/_jsx(\"span\", {\n                    className: Styles.charts,\n                    children: item.number_words\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsxs(Tooltip, {\n                  title: \"\\u67E5\\u770B\",\n                  color: \"#50bcb6\",\n                  overlayStyle: {\n                    borderRadius: '4px'\n                  },\n                  children: [/*#__PURE__*/_jsx(MehOutlined, {\n                    className: Styles.icon\n                  }), /*#__PURE__*/_jsx(\"span\", {\n                    className: Styles.charts,\n                    children: item.viewCount\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsxs(Tooltip, {\n                  title: \"\\u70B9\\u8D5E\",\n                  color: \"#ffa800\",\n                  overlayStyle: {\n                    borderRadius: '4px'\n                  },\n                  children: [/*#__PURE__*/_jsx(HeartOutlined, {\n                    className: Styles.icon\n                  }), /*#__PURE__*/_jsx(\"span\", {\n                    className: Styles.charts,\n                    children: item.likeCount\n                  })]\n                })\n              })]\n            })]\n          })]\n        }, item.id);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderHomeBlogList\", function () {\n      var blogList = _this.state.blogList;\n      var item = blogList.length > 0 ? blogList[blogList.length - 1] : {\n        id: 1,\n        createDate: '',\n        content: '',\n        title: ''\n      };\n      return /*#__PURE__*/_jsxs(\"div\", {\n        className: Styles.info,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Styles.time,\n          children: moment(item.createDate).format('YYYY-MM-DD')\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.title,\n          children: /*#__PURE__*/_jsx(Link, {\n            href: '/' + String(item.id),\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: item.title\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.text,\n          dangerouslySetInnerHTML: {\n            __html: marked(item.content, {\n              gfm: true,\n              xhtml: false\n            })\n          }\n        })]\n      });\n    });\n\n    _this.state = {\n      fatherBox: {},\n      imgBoxStyle: {},\n      navHied: false,\n      loadingMore: false,\n      screenHeight: 0,\n      blogList: [],\n      pageNo: 1,\n      pageSize: 5,\n      total: 0\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var _this$state2 = this.state,\n          pageNo = _this$state2.pageNo,\n          pageSize = _this$state2.pageSize;\n      this.initParallax(this.scene.current);\n      window.addEventListener('resize', this.disposeScreen, false);\n      this.disposeScreen();\n      document.addEventListener('scroll', function () {\n        clearInterval(_this2.timer);\n      });\n      this.initData(pageNo, pageSize);\n    }\n  }, {\n    key: \"initData\",\n    value: function () {\n      var _initData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(pageNo, pageSize) {\n        var responseData;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  loadingMore: true\n                });\n                _context.next = 3;\n                return getBlogList({\n                  pageNo: pageNo,\n                  pageSize: pageSize\n                });\n\n              case 3:\n                responseData = _context.sent;\n                this.setState({\n                  blogList: responseData.list,\n                  total: responseData.total,\n                  loadingMore: false\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function initData(_x, _x2) {\n        return _initData.apply(this, arguments);\n      }\n\n      return initData;\n    }()\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.disposeScreen);\n    }\n  }, {\n    key: \"calculateFatherBox\",\n    value: function calculateFatherBox(w, h) {\n      var _w = parseInt(w),\n          _h = parseInt(h),\n          x,\n          y,\n          i,\n          e = _w >= 1000 || _h >= 1000 ? 1000 : 500;\n\n      if (_w >= _h) {\n        i = _w / e * 50;\n        y = i;\n        x = i * _w / _h;\n      } else {\n        i = _h / e * 50;\n        x = i;\n        y = i * _h / _w;\n      }\n\n      var featherBox = {\n        width: _w + x + 'px',\n        height: _h + y + 'px',\n        marginLeft: -0.5 * x + 'px',\n        marginTop: -0.5 * y + 'px'\n      };\n      var imgBoxStyle = this.calculateBox(_w + x, _h + y);\n      return {\n        featherBox: featherBox,\n        imgBoxStyle: imgBoxStyle\n      };\n    }\n  }, {\n    key: \"calculateBox\",\n    value: function calculateBox(w, h) {\n      var width = parseInt(w),\n          height = parseInt(h),\n          ratio = 1080 / 1920,\n          style = {};\n      var compute = height / width > ratio;\n      style['width'] = compute ? height / ratio + 'px' : \"\".concat(width, \"px\");\n      style['height'] = compute ? \"\".concat(height, \"px\") : width * ratio + 'px';\n      style['left'] = (width - parseInt(style.width)) / 2 + 'px';\n      style['top'] = (height - parseInt(style.height)) / 2 + 'px';\n      return style;\n    } // 我是真塔喵的菜\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return /*#__PURE__*/_jsxs(\"div\", {\n        className: Styles.container,\n        children: [/*#__PURE__*/_jsx(Helmet, {\n          title: \" home | \\u5C0F\\u818F\"\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: Styles.home,\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            ref: this.scene,\n            className: Styles.scene,\n            style: {\n              height: this.state.screenHeight + 'px'\n            },\n            children: /*#__PURE__*/_jsx(\"div\", {\n              \"data-depth\": \"0.4\",\n              className: Styles.bg,\n              style: this.state.fatherBox,\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: \"/image/bg.png\",\n                style: this.state.imgBoxStyle\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Styles.head,\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: Styles.logo,\n              style: !this.state.navHied ? {\n                color: '#fff'\n              } : {\n                color: '#333'\n              },\n              children: /*#__PURE__*/_jsx(\"i\", {\n                className: \"web-font\",\n                children: \"\\u5C0F \\xB7 \\u818F\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: Styles.menu,\n              children: !this.state.navHied ? /*#__PURE__*/_jsx(AlignRightOutlined, {\n                className: \"iconfont\",\n                onClick: function onClick() {\n                  return _this3.onNavHide(true);\n                }\n              }) : /*#__PURE__*/_jsx(CloseOutlined, {\n                onClick: function onClick() {\n                  return _this3.onNavHide(false);\n                },\n                className: \"iconfont\"\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: Styles.misk\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: Styles.post,\n            children: this.renderHomeBlogList()\n          }), this.renderNav()]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: Styles.content,\n          children: [this.renderBlogList(), /*#__PURE__*/_jsx(\"div\", {\n            className: Styles.more,\n            children: this.state.total === this.state.blogList.length ? /*#__PURE__*/_jsx(\"div\", {\n              className: Styles.bottomTest,\n              children: \"\\u5230\\u5E95\\u4E86\"\n            }) : this.state.loadingMore ? /*#__PURE__*/_jsx(LoadingDom, {}) : /*#__PURE__*/_jsx(\"div\", {\n              className: Styles.loadingBtn,\n              onClick: this.loadMore,\n              children: \"\\u52A0\\u8F7D\\u66F4\\u591A \"\n            })\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.foot,\n          children: /*#__PURE__*/_jsx(\"a\", {\n            target: \"_blank\",\n            children: \"\\u7CA4ICP\\u5907181222222\\u53F7\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Styles.navigationBar,\n          onClick: this.onSlide,\n          children: /*#__PURE__*/_jsx(SortDescendingOutlined, {})\n        })]\n      });\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport var __N_SSG = true;\nexport var getBlogList = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(params) {\n    var _yield$getIndexPageDa, data, success;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return getIndexPageData({\n              pageNo: params.pageNo,\n              pageSize: params.pageSize\n            });\n\n          case 3:\n            _yield$getIndexPageDa = _context2.sent;\n            data = _yield$getIndexPageDa.data;\n            success = _yield$getIndexPageDa.success;\n\n            if (success) {\n              _context2.next = 8;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", message.error('请求错误'));\n\n          case 8:\n            return _context2.abrupt(\"return\", data);\n\n          case 11:\n            _context2.prev = 11;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n\n          case 14:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 11]]);\n  }));\n\n  return function getBlogList(_x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport default App;","map":null,"metadata":{},"sourceType":"module"}